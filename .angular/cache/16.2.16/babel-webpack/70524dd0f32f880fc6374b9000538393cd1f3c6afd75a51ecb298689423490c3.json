{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../comic/services/comic.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"../../home/left-content/left-content.component\";\nconst _c0 = function (a1) {\n  return [\"/comic\", a1];\n};\nfunction ListAllComicComponent_ng_container_7_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"div\", 14)(2, \"div\", 15)(3, \"span\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(5, \"img\", 16);\n    i0.ɵɵelementStart(6, \"div\", 17)(7, \"h3\");\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"slice\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"p\");\n    i0.ɵɵtext(11);\n    i0.ɵɵpipe(12, \"date\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const c_r5 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(13, _c0, c_r5.id));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" Rating: \", c_r5.averageRating > 0 ? c_r5.averageRating + \" \\u2B50\" : \"Not rated yet\", \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", c_r5.thumbnail ? c_r5.thumbnail : \"assets/default-image.jpg\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(((c_r5 == null ? null : c_r5.name) || \"\").length > 20 ? i0.ɵɵpipeBind3(9, 6, c_r5 == null ? null : c_r5.name, 0, 20) + \"...\" : c_r5 == null ? null : c_r5.name);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"\", c_r5 == null ? null : c_r5.comicCategory == null ? null : c_r5.comicCategory.name, \" / \", i0.ɵɵpipeBind2(12, 10, c_r5 == null ? null : c_r5.onSaleDate, \"dd/MM/yyyy\"), \"\");\n  }\n}\nfunction ListAllComicComponent_ng_container_7_li_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\", 10)(1, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function ListAllComicComponent_ng_container_7_li_8_Template_button_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const page_r6 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r7.onPageChange(page_r6));\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const page_r6 = ctx.$implicit;\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"active\", ctx_r4.pageNumber === page_r6)(\"disabled\", page_r6 === \"...\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", page_r6 === \"...\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", page_r6, \" \");\n  }\n}\nfunction ListAllComicComponent_ng_container_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 7);\n    i0.ɵɵtemplate(2, ListAllComicComponent_ng_container_7_div_2_Template, 13, 15, \"div\", 8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"nav\")(4, \"ul\", 9)(5, \"li\", 10)(6, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function ListAllComicComponent_ng_container_7_Template_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.onPageChange(ctx_r9.pageNumber - 1));\n    });\n    i0.ɵɵtext(7, \"Previous\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(8, ListAllComicComponent_ng_container_7_li_8_Template, 3, 6, \"li\", 12);\n    i0.ɵɵelementStart(9, \"li\", 10)(10, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function ListAllComicComponent_ng_container_7_Template_button_click_10_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.onPageChange(ctx_r11.pageNumber + 1));\n    });\n    i0.ɵɵtext(11, \"Next\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.comics);\n    i0.ɵɵadvance(3);\n    i0.ɵɵclassProp(\"disabled\", ctx_r0.pageNumber === 1);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.paginationPages);\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassProp(\"disabled\", ctx_r0.pageNumber === ctx_r0.totalPages);\n  }\n}\nfunction ListAllComicComponent_ng_template_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 4);\n    i0.ɵɵtext(1, \"No comics available.\");\n    i0.ɵɵelementEnd();\n  }\n}\nlet ListAllComicComponent = /*#__PURE__*/(() => {\n  class ListAllComicComponent {\n    constructor(comicService, route) {\n      this.comicService = comicService;\n      this.route = route;\n      this.comics = [];\n      this.totalItems = 0;\n      this.totalPages = 0;\n      this.pageNumber = 1;\n      this.pageSize = 5;\n      this.filterOn = '';\n      this.filterQuery = '';\n      this.paginationPages = [];\n    }\n    ngOnInit() {\n      this.loadComics();\n    }\n    loadComics() {\n      this.route.queryParams.subscribe(params => {\n        this.filterOn = params['filterOn'];\n        this.filterQuery = params['filterQuery'];\n        this.comicsSubscription = this.comicService.getAllComic(this.filterOn, this.filterQuery, this.pageNumber, this.pageSize).subscribe({\n          next: response => {\n            this.comics = response.comics;\n            this.totalItems = response.totalItems;\n            this.totalPages = response.totalPages;\n            //    console.log('Comics:', this.comics);\n            //    console.log('Total items:', this.totalItems);\n            //   console.log('Total pages:', this.totalPages);\n            this.updatePagination();\n          },\n          error: error => {\n            console.error('Error loading comics:', error);\n          }\n        });\n      });\n    }\n    updatePagination() {\n      const pageLinks = []; // Khai báo kiểu Array<string | number>\n      // Always show the first page\n      pageLinks.push(1);\n      // Show \"...\" if the pages are too many\n      if (this.pageNumber > 3) {\n        pageLinks.push('...');\n      }\n      // Show nearby pages\n      for (let i = Math.max(2, this.pageNumber - 2); i <= Math.min(this.totalPages - 1, this.pageNumber + 2); i++) {\n        pageLinks.push(i);\n      }\n      // Show \"...\" if the pages are too many\n      if (this.pageNumber < this.totalPages - 2) {\n        pageLinks.push('...');\n      }\n      // Always show the last page\n      if (this.totalPages > 1) {\n        pageLinks.push(this.totalPages);\n      }\n      this.paginationPages = pageLinks;\n    }\n    onPageChange(page) {\n      if (page === '...') return; // Do nothing for \"...\"\n      this.pageNumber = page; // Chuyển về kiểu number\n      this.loadComics();\n    }\n    ngOnDestroy() {\n      if (this.comicsSubscription) {\n        this.comicsSubscription.unsubscribe();\n      }\n    }\n    static {\n      this.ɵfac = function ListAllComicComponent_Factory(t) {\n        return new (t || ListAllComicComponent)(i0.ɵɵdirectiveInject(i1.ComicService), i0.ɵɵdirectiveInject(i2.ActivatedRoute));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: ListAllComicComponent,\n        selectors: [[\"app-list-all-comic\"]],\n        decls: 10,\n        vars: 5,\n        consts: [[1, \"container\", \"py-5\"], [1, \"row\"], [1, \"col-md-4\", 2, \"color\", \"#171717\"], [1, \"col-md-8\"], [1, \"text-white\"], [4, \"ngIf\", \"ngIfElse\"], [\"noData\", \"\"], [1, \"row\", \"g-3\"], [\"class\", \"col-md-2\", 4, \"ngFor\", \"ngForOf\"], [1, \"pagination\", \"justify-content-center\", \"mt-3\"], [1, \"page-item\"], [1, \"page-link\", 3, \"click\"], [\"class\", \"page-item\", 3, \"active\", \"disabled\", 4, \"ngFor\", \"ngForOf\"], [1, \"col-md-2\"], [1, \"card\", 3, \"routerLink\"], [1, \"rating\"], [3, \"src\"], [1, \"card-content\"], [1, \"page-link\", 3, \"disabled\", \"click\"]],\n        template: function ListAllComicComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2);\n            i0.ɵɵelement(3, \"app-left-content\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"div\", 3)(5, \"h3\", 4);\n            i0.ɵɵtext(6);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(7, ListAllComicComponent_ng_container_7_Template, 12, 6, \"ng-container\", 5);\n            i0.ɵɵtemplate(8, ListAllComicComponent_ng_template_8_Template, 2, 0, \"ng-template\", null, 6, i0.ɵɵtemplateRefExtractor);\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            const _r1 = i0.ɵɵreference(9);\n            i0.ɵɵadvance(6);\n            i0.ɵɵtextInterpolate3(\" Your query found \", ctx.totalItems, \" answers (Query results \", (ctx.pageNumber - 1) * ctx.pageSize + 1, \" - \", ctx.pageNumber * ctx.pageSize, \"): \");\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", ctx.comics.length > 0)(\"ngIfElse\", _r1);\n          }\n        },\n        dependencies: [i3.NgForOf, i3.NgIf, i2.RouterLink, i4.LeftContentComponent, i3.SlicePipe, i3.DatePipe],\n        styles: [\".pagination[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff;border:none}.pagination[_ngcontent-%COMP%]   .page-item.active[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{background-color:#343a40;color:#fff;border:none}.pagination[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]:hover{background-color:#5a6268;color:#fff;border:none}\"]\n      });\n    }\n  }\n  return ListAllComicComponent;\n})();\nexport { ListAllComicComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}